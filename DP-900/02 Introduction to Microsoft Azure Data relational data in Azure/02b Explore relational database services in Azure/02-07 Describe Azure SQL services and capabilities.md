
_Azure SQL_ คือชื่อเรียกรวมของบริการฐานข้อมูลที่ใช้พื้นฐานจาก _Microsoft SQL Server_ ซึ่งมีหลายรูปแบบให้เลือกใช้ตามความต้องการ โดยแต่ละบริการมีคุณสมบัติและระดับการจัดการที่แตกต่างกัน ดังนี้

_SQL Server on Azure Virtual Machines (VMs)_ เป็นบริการในรูปแบบ _infrastructure-as-a-service (IaaS)_ โดยใช้ _VM_ ที่ติดตั้ง _SQL Server_ ไว้เรียบร้อย ทำให้เหมาะสำหรับการย้ายระบบจากเครื่องในองค์กร (_on-premises_) ขึ้นคลาวด์แบบ _lift and shift_ โดยไม่ต้องเปลี่ยนโค้ดหรือตั้งค่าระบบมากนัก

_Azure SQL Managed Instance_ เป็นบริการแบบ _platform-as-a-service (PaaS)_ ที่ออกแบบมาให้มี _compatibility_ ใกล้เคียงกับ _SQL Server_ ในองค์กรเกือบ 100% โดยผู้ใช้ไม่ต้องดูแลระบบปฏิบัติการหรือฮาร์ดแวร์ ระบบจะจัดการงานบำรุงรักษา เช่น _software update_, _backup_ และงานประจำอื่น ๆ ให้แบบอัตโนมัติ

_Azure SQL Database_ เป็นบริการ _PaaS_ ที่บริหารจัดการให้อย่างเต็มรูปแบบ (_fully managed_) และสามารถ _scale_ ได้สูง เหมาะสำหรับการสร้าง _application_ ใหม่บนคลาวด์ โดยยังคงความสามารถของฐานข้อมูลระดับเดียวกับ _SQL Server_ ที่ติดตั้งในองค์กร

_Azure SQL Edge_ เป็น _SQL engine_ ที่ออกแบบมาสำหรับงานด้าน _Internet-of-Things (IoT)_ โดยเฉพาะ โดยรองรับข้อมูล _time-series_ และการประมวลผลแบบ _streaming_ เหมาะสำหรับอุปกรณ์ขนาดเล็กหรือระบบที่ต้องการการประมวลผลใกล้แหล่งข้อมูล (_edge computing_)

## Compare Azure SQL services

|                         | _SQL Server on Azure VMs_                                                                                                                                           | _Azure SQL Managed Instance_                                                                                                                                           | _Azure SQL Database_                                                                                                                                           |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                         | ![SQL Server VM](https://learn.microsoft.com/en-us/training/wwl-data-ai/explore-provision-deploy-relational-database-offerings-azure/media/azure-sql-vm.png) | ![SQL Managed Instance](https://learn.microsoft.com/en-us/training/wwl-data-ai/explore-provision-deploy-relational-database-offerings-azure/media/azure-sql-managed-instance.png) | ![SQL Database](https://learn.microsoft.com/en-us/training/wwl-data-ai/explore-provision-deploy-relational-database-offerings-azure/media/azure-sql-database.png) |
| _Type of cloud service_ | _IaaS_                                                                                                                                                              | _PaaS_                                                                                                                                                                 | _PaaS_                                                                                                                                                          |
| _SQL Server compatibility_ | _compatible_ กับ _on-premises_ เต็มรูปแบบ เหมาะสำหรับการ _lift and shift_                                                                                      | _near-100% compatibility_ กับ _SQL Server_ ในองค์กร ย้ายระบบได้โดยไม่ต้องแก้โค้ดมากนัก                                                                                   | รองรับ _core features_ ของ _SQL Server_ ส่วนใหญ่ แต่บางฟีเจอร์จากระบบเดิมอาจไม่สามารถใช้ได้                                                                 |
| _Architecture_          | ติดตั้ง _SQL Server_ บน _VM_ โดยตรง รองรับหลาย _database_ ต่อ _instance_                                                                                         | _managed instance_ รองรับหลาย _database_ และสามารถใช้ _instance pool_ เพื่อแชร์ทรัพยากร                                                                               | ใช้งานได้ทั้งแบบ _single database_ หรือ _elastic pool_ เพื่อแชร์ทรัพยากรระหว่างหลาย _database_                                                           |
| _Availability_          | _99.99%_                                                                                                                                                            | _99.99%_                                                                                                                                                               | _99.995%_                                                                                                                                                       |
| _Management_            | ต้องดูแลเองทั้งหมด เช่น _OS update_, _SQL Server patching_, _backup_, และงาน _maintenance_ อื่น ๆ                                                                   | ระบบจัดการให้อัตโนมัติ ทั้งการอัปเดต _backup_ และ _recovery_                                                                                                         | จัดการให้อัตโนมัติเช่นเดียวกัน                                                                                                                               |
| _Use cases_             | เหมาะสำหรับองค์กรที่ต้องการย้ายระบบเดิมขึ้นคลาวด์ และยังต้องการควบคุมการตั้งค่าทุกอย่าง                                                                         | เหมาะกับการย้ายระบบขึ้นคลาวด์ที่ต้องการเปลี่ยนน้อยที่สุด                                                                                                               | เหมาะกับการพัฒนา _application_ ใหม่บนคลาวด์ หรือระบบที่ไม่มีความซับซ้อนด้านการตั้งค่าระดับ _instance_                                                   |

## SQL Server on Azure Virtual Machines

_SQL Server on Azure Virtual Machines_ คือการใช้งาน _SQL Server_ แบบเต็มรูปแบบบนคลาวด์ โดยไม่ต้องดูแลฮาร์ดแวร์ในองค์กรเอง นี่คือตัวอย่างของแนวทางแบบ _IaaS_

การติดตั้ง _SQL Server_ บน _Azure VM_ จะให้ประสบการณ์เหมือนการใช้งานบนเครื่องจริงในองค์กร (_on-premises_) การย้ายจากระบบเดิมมาที่ Azure ก็คล้ายกับการย้ายฐานข้อมูลจากเซิร์ฟเวอร์หนึ่งไปอีกเซิร์ฟเวอร์หนึ่งในองค์กร

แนวทางนี้เหมาะสำหรับการ _migrate_ ระบบเดิมขึ้นคลาวด์ และสำหรับ _application_ ที่จำเป็นต้องเข้าถึงฟีเจอร์ของระบบปฏิบัติการ ซึ่งบริการแบบ _PaaS_ อาจไม่รองรับ

_SQL Server_ บน _Azure VMs_ รองรับการย้ายระบบแบบ _lift-and-shift_ ได้ทันที โดยแทบไม่ต้องแก้โค้ดใด ๆ และยังสามารถใช้เพื่อขยายระบบที่มีอยู่เดิมจากองค์กรไปสู่คลาวด์แบบ _hybrid_ ได้อีกด้วย

คุณสามารถใช้ _SQL Server_ บน _virtual machine_ เพื่อพัฒนาและทดสอบ _application_ แบบดั้งเดิมที่ใช้ _SQL Server_ ได้อย่างเต็มที่ ด้วย _VM_ คุณจะมีสิทธิ์ในการจัดการระบบปฏิบัติการและ _DBMS_ อย่างสมบูรณ์ เหมาะสำหรับองค์กรที่มีทีม _IT_ พร้อมดูแลระบบอยู่แล้ว

ความสามารถเหล่านี้ช่วยให้คุณสามารถ:

- สร้างสภาพแวดล้อมสำหรับการพัฒนาและทดสอบได้อย่างรวดเร็ว โดยไม่ต้องลงทุนซื้อฮาร์ดแวร์สำหรับ _non-production_ บน _on-premises_
- เตรียมความพร้อมสำหรับการ _lift-and-shift_ แอปพลิเคชันเดิมขึ้นคลาวด์ได้อย่างรวดเร็ว โดยไม่ต้องปรับเปลี่ยนระบบมากนัก หรือไม่ต้องเปลี่ยนเลย
- ขยายขนาดของระบบที่รัน _SQL Server_ ได้ง่าย เช่น การเพิ่ม _CPU_, _memory_ หรือ _disk space_ ให้กับ _virtual machine_ โดยไม่จำเป็นต้องติดตั้งซอฟต์แวร์ใหม่ในเครื่องนั้น

### Business benefits

การใช้ _SQL Server_ บน _virtual machines_ ช่วยให้คุณสามารถตอบสนองความต้องการทางธุรกิจที่หลากหลายได้ โดยผสมผสานการใช้งานแบบ _on-premises_ และแบบคลาวด์เข้าด้วยกัน ข้อดีคือคุณยังคงใช้เครื่องมือพัฒนา ความรู้ และผลิตภัณฑ์ _server_ เดิมที่มีอยู่ได้ในทั้งสองสภาพแวดล้อม

สำหรับหลายองค์กร การเปลี่ยนไปใช้บริการแบบ _fully managed_ อาจไม่ใช่เรื่องง่าย เนื่องจากอาจมีข้อกำหนดเฉพาะที่ต้องปรับเปลี่ยนใน _database_ และ _application_ เพื่อให้สามารถใช้งานบริการแบบ _managed_ ได้

ดังนั้น การใช้ _virtual machine_ จึงเป็นทางเลือกที่ดีในระยะสั้นหรือในสถานการณ์ที่ซับซ้อน แต่ก็ไม่ได้หมายความว่าคุณจะไม่ต้องดูแล _DBMS_ อีกต่อไป คุณยังจำเป็นต้องบริหารจัดการ _SQL Server_ อย่างรอบคอบเหมือนกับที่ทำในระบบ _on-premises_

## Azure SQL Managed Instance

_Azure SQL Managed Instance_ คือการใช้งาน _SQL Server_ แบบ _instance_ เต็มรูปแบบบนคลาวด์ คุณสามารถติดตั้งหลาย _databases_ บน _instance_ เดียวได้ และมีสิทธิ์ควบคุม _instance_ นี้ได้อย่างเต็มที่ เช่นเดียวกับการดูแลเซิร์ฟเวอร์ในองค์กร (_on-premises_)

บริการนี้จะจัดการงานทั่วไปให้อัตโนมัติ เช่น _backup_, การอัปเดตซอฟต์แวร์ (_patching_), การตรวจสอบสถานะของฐานข้อมูล (_monitoring_) แต่คุณยังมีอำนาจควบคุมด้าน _security_ และการจัดสรรทรัพยากรของแต่ละ _database_ อย่างเต็มที่

ระบบ _managed instance_ จะเชื่อมโยงกับบริการอื่นของ Azure เช่น:

- _Azure Storage_ สำหรับการ _backup_
- _Azure Event Hubs_ สำหรับ _telemetry_
- _Microsoft Entra ID_ สำหรับการยืนยันตัวตน
- _Azure Key Vault_ สำหรับการเข้ารหัสข้อมูล (_Transparent Data Encryption - TDE_)
- และบริการแพลตฟอร์มอื่น ๆ ที่เกี่ยวข้องกับ _security_ และ _support_

การสื่อสารระหว่างบริการทั้งหมดจะถูกเข้ารหัส (_encrypted_) และลงลายเซ็น (_signed_) ด้วย _certificates_ โดยตลอดเวลาระบบจะตรวจสอบความน่าเชื่อถือของใบรับรองเหล่านี้ผ่าน _certificate revocation lists_ หากพบว่าใบรับรองถูกเพิกถอน _managed instance_ จะตัดการเชื่อมต่อทันทีเพื่อปกป้องข้อมูล

### Use cases

ควรพิจารณาใช้ _Azure SQL Managed Instance_ หากคุณต้องการย้าย (_lift-and-shift_) _SQL Server instance_ ที่ใช้งานในองค์กรขึ้นคลาวด์ พร้อมทั้ง _databases_ ทั้งหมด โดยไม่ต้องแบกรับภาระในการดูแลระบบเหมือนกับการใช้งานบน _virtual machine_

_Azure SQL Managed Instance_ มีความสามารถบางอย่างที่ _Azure SQL Database_ ไม่มี เช่น

- _linked servers_ สำหรับเชื่อมต่อกับเซิร์ฟเวอร์อื่น
- _Service Broker_ ระบบส่งข้อความที่ใช้กระจายงานไปยังหลายเซิร์ฟเวอร์
- _Database Mail_ ที่ช่วยให้ฐานข้อมูลสามารถส่งอีเมลหาผู้ใช้ได้

หากระบบของคุณใช้ฟีเจอร์เหล่านี้ ควรเลือกใช้ _managed instance_

คุณสามารถใช้เครื่องมือที่ชื่อว่า _Data Migration Assistant (DMA)_ เพื่อตรวจสอบความเข้ากันได้ของระบบเดิม โดย _DMA_ จะวิเคราะห์ _database_ บน _SQL Server_ และรายงานปัญหาที่อาจทำให้ไม่สามารถย้ายมาที่ _managed instance_ ได้

### Business benefits

_Azure SQL Managed Instance_ ช่วยให้ผู้ดูแลระบบใช้เวลาน้อยลงกับงานด้าน _administration_ เพราะระบบจะทำให้อัตโนมัติ หรือช่วยลดความซับซ้อนของงานเหล่านั้น ตัวอย่างงานที่ระบบจัดการให้ ได้แก่

- การติดตั้งและอัปเดต _operating system_ และ _DBMS_
- การปรับขนาดและตั้งค่า _instance_ แบบ _dynamic_
- การสำรองข้อมูล (_backup_)
- การจำลองฐานข้อมูล (_replication_) รวมถึงฐานข้อมูลระบบ
- การตั้งค่า _high availability_
- การส่งข้อมูลสถานะระบบและประสิทธิภาพ (_health and performance monitoring_)

บริการนี้ยังมี _compatibility_ ใกล้เคียงกับ _SQL Server Enterprise Edition_ ที่รันอยู่ในองค์กรเกือบ 100%

เรื่องการยืนยันตัวตน _Azure SQL Managed Instance_ รองรับทั้ง:

- การเข้าสู่ระบบด้วย _SQL Server logins_ (ชื่อผู้ใช้และรหัสผ่าน ต้องใส่ทุกครั้งที่เชื่อมต่อ)
- และ _Microsoft Entra ID_ (ใช้บัญชีที่ล็อกอินอยู่ในคอมพิวเตอร์ ไม่ต้องกรอกข้อมูลใหม่ทุกครั้ง)

## Azure SQL Database

_Azure SQL Database_ เป็นบริการแบบ _PaaS_ จาก Microsoft คุณสามารถสร้าง _managed database server_ บนคลาวด์ แล้วนำ _databases_ ของคุณไปติดตั้งบนเซิร์ฟเวอร์นี้

> _หมายเหตุ_:  
> _SQL Database server_ เป็นโครงสร้างเชิงตรรกะ (_logical construct_) ที่ทำหน้าที่เป็นจุดศูนย์กลางสำหรับจัดการหลาย _single databases_ หรือ _pooled databases_ รวมถึงการจัดการ _logins_, กฎ _firewall_, กฎ _auditing_, นโยบาย _threat detection_, และ _failover groups_

_Azure SQL Database_ มีให้เลือกใช้งาน 2 รูปแบบ คือ

- _Single Database_: ฐานข้อมูลแยกเดี่ยวที่มีทรัพยากรของตัวเอง
- _Elastic Pool_: กลุ่มฐานข้อมูลที่แชร์ทรัพยากรร่วมกัน ช่วยประหยัดต้นทุนเมื่อฐานข้อมูลมีการใช้งานที่ไม่พร้อมกัน


### Single Database

ตัวเลือกนี้ช่วยให้คุณสามารถตั้งค่าและใช้งาน _SQL Server database_ เดี่ยวได้อย่างรวดเร็ว คุณจะสร้าง _database server_ บนคลาวด์ แล้วเข้าถึง _database_ ของคุณผ่านทางเซิร์ฟเวอร์นี้

Microsoft จะดูแลการจัดการ _server_ ให้ทั้งหมด สิ่งที่คุณต้องทำมีแค่การกำหนดค่าฐานข้อมูล (_configure_), สร้าง _tables_ และใส่ข้อมูลเข้าไป

คุณสามารถ _scale_ ฐานข้อมูลได้หากต้องการเพิ่มพื้นที่จัดเก็บ หน่วยความจำ หรือพลังประมวลผล โดยค่าเริ่มต้นระบบจะจัดสรรทรัพยากรไว้ล่วงหน้า (_preallocated_) และคิดค่าบริการเป็นรายชั่วโมงตามจำนวนทรัพยากรที่ร้องขอ

คุณยังสามารถเลือกใช้การตั้งค่าแบบ _serverless_ ได้อีกด้วย ซึ่งในรูปแบบนี้ Microsoft จะสร้าง _server_ ที่อาจใช้ร่วมกับฐานข้อมูลของผู้ใช้ Azure รายอื่น (แต่รับรองความเป็นส่วนตัวของคุณอย่างปลอดภัย) ฐานข้อมูลของคุณจะ _scale_ แบบอัตโนมัติ และระบบจะจัดสรรหรือคืนทรัพยากรตามความต้องการแบบ _on-demand_

### Elastic Pool

ตัวเลือกนี้คล้ายกับ _Single Database_ แต่ต่างกันตรงที่โดยค่าเริ่มต้น _databases_ หลายตัวสามารถแชร์ทรัพยากรร่วมกันได้ เช่น _memory_, พื้นที่เก็บข้อมูล, และพลังประมวลผล ซึ่งการแชร์ทรัพยากรนี้เรียกว่า _pool_

คุณจะเป็นผู้สร้าง _elastic pool_ และเฉพาะ _databases_ ของคุณเท่านั้นที่สามารถใช้ทรัพยากรใน _pool_ นี้ได้

รูปแบบนี้เหมาะมากหากคุณมี _databases_ ที่มีความต้องการใช้ทรัพยากรไม่สม่ำเสมอในแต่ละช่วงเวลา และต้องการลดค่าใช้จ่าย เช่น

- _database_ สำหรับการจ่ายเงินเดือน (_payroll_) ที่ต้องใช้ _CPU_ สูงมากในช่วงสิ้นเดือน แต่ช่วงอื่นแทบไม่มีการใช้งาน
- อีก _database_ หนึ่งอาจใช้สำหรับรายงานผู้บริหาร ซึ่งจะทำงานหนักช่วงกลางเดือน แล้วเบาลงในช่วงอื่น

ด้วย _Elastic Pool_ คุณสามารถใช้ทรัพยากรภายใน _pool_ ตามที่ต้องการ แล้วปล่อยคืนระบบเมื่อประมวลผลเสร็จ ช่วยเพิ่มประสิทธิภาพและประหยัดต้นทุน

### Use cases

_Use cases_  
_Azure SQL Database_ เป็นตัวเลือกที่เหมาะที่สุดสำหรับงานที่ต้องการต้นทุนต่ำและการดูแลรักษาระบบน้อย เนื่องจากเป็นบริการแบบ _PaaS_ ที่จัดการทุกอย่างให้โดยอัตโนมัติ

อย่างไรก็ตาม _Azure SQL Database_ อาจไม่ _compatible_ กับระบบ _SQL Server_ ที่ติดตั้งในองค์กรแบบเต็ม 100% จึงเหมาะกับโปรเจกต์ที่เริ่มพัฒนาบนคลาวด์ใหม่ โดยสามารถออกแบบ _application_ ให้รองรับการเปลี่ยนแปลงที่จำเป็นได้

> _หมายเหตุ_:  
> คุณสามารถใช้ _Data Migration Assistant_ เพื่อตรวจสอบปัญหาด้าน _compatibility_ ของ _databases_ ที่อาจกระทบต่อการทำงานเมื่อย้ายไปใช้ _Azure SQL Database_  
> ดูรายละเอียดเพิ่มเติมได้ที่: _Overview of Data Migration Assistant_

_Azure SQL Database_ มักใช้ในกรณีดังต่อไปนี้:

- _modern cloud applications_ ที่ต้องการใช้ฟีเจอร์ล่าสุดของ _SQL Server_ ที่เสถียรและทันสมัย  
- _applications_ ที่ต้องการ _high availability_  
- ระบบที่มีโหลดไม่คงที่ และต้องการ _scale_ ระบบขึ้นหรือลงอย่างรวดเร็วตามปริมาณการใช้งาน

### Business benefits

_Azure SQL Database_ จะทำการอัปเดตและติดตั้ง _patch_ ให้กับซอฟต์แวร์ _SQL Server_ โดยอัตโนมัติเพื่อให้คุณใช้งานเวอร์ชันที่ทันสมัยและปลอดภัยที่สุดอยู่เสมอ

คุณสมบัติด้าน _scalability_ ของบริการนี้ช่วยให้คุณสามารถเพิ่มทรัพยากรเพื่อรองรับการจัดเก็บและประมวลผลข้อมูลได้ โดยไม่ต้องเสียค่าใช้จ่ายในการอัปเกรดระบบแบบแมนนวล

บริการนี้ยังมีการรับประกัน _high availability_ ที่ระดับ _99.995%_ และรองรับ _point-in-time restore_ ซึ่งช่วยให้คุณสามารถกู้คืนฐานข้อมูลกลับไปยังช่วงเวลาใดก็ได้ในอดีต นอกจากนี้ยังสามารถ _replicate_ ฐานข้อมูลไปยังภูมิภาคอื่นเพื่อเสริมความ _resiliency_ และรองรับสถานการณ์ _disaster recovery_

ระบบ _advanced threat protection_ จะเพิ่มความสามารถด้านความปลอดภัย เช่น:

- _vulnerability assessment_ เพื่อตรวจสอบและแก้ไขจุดอ่อนที่อาจทำให้เกิดปัญหาความปลอดภัย
- ตรวจจับกิจกรรมผิดปกติที่อาจเป็นสัญญาณของการโจมตี เช่น _SQL injection_
- เฝ้าระวังฐานข้อมูลอย่างต่อเนื่อง และแจ้งเตือนทันทีเมื่อพบพฤติกรรมต้องสงสัย พร้อมคำแนะนำในการตรวจสอบและจัดการภัยคุกคาม

ฟีเจอร์ _auditing_ จะติดตามเหตุการณ์ต่าง ๆ ของฐานข้อมูล และบันทึกลงใน _audit log_ ที่เก็บไว้ใน _Azure Storage account_ ซึ่งช่วยในการรักษาความสอดคล้องตามข้อกำหนด (_compliance_) วิเคราะห์พฤติกรรมของระบบ และระบุความผิดปกติที่อาจบ่งบอกถึงปัญหาทางธุรกิจหรือภัยคุกคามด้านความปลอดภัย

_SQL Database_ ยังช่วยปกป้องข้อมูลของคุณด้วยระบบ _encryption_ ทั้งขณะจัดเก็บ (_at rest_) และขณะรับส่งผ่านเครือข่าย (_in motion_) เพื่อรักษาความปลอดภัยของข้อมูลอย่างครอบคลุม