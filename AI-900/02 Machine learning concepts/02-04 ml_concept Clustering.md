
# Clustering

*Clustering* เป็นรูปแบบหนึ่งของ *unsupervised machine learning*  
ซึ่งใช้ในการจัดกลุ่มข้อมูลตามความคล้ายคลึงกันของค่า feature ต่าง ๆ  
การเรียนรู้แบบนี้เรียกว่า *unsupervised* เพราะไม่ได้ใช้ label ที่รู้ล่วงหน้าในการฝึกโมเดล

ในโมเดลแบบ clustering สิ่งที่ได้ไม่ใช่ label เดิม แต่คือหมายเลขของ *cluster*  
ที่บ่งบอกว่า observation แต่ละตัวถูกจัดให้อยู่ในกลุ่มใด โดยพิจารณาจาก feature เพียงอย่างเดียว

## Example – Clustering

ตัวอย่างเช่น นักพฤกษศาสตร์เก็บตัวอย่างดอกไม้ และบันทึกจำนวน *กลีบดอก* และ *ใบ* ของแต่ละดอก  
โดยไม่มี label ว่าดอกไม้แต่ละดอกเป็นสายพันธุ์อะไร

เป้าหมายของโมเดลจึงไม่ใช่การระบุชนิดของดอกไม้  
แต่คือการจัดกลุ่มดอกไม้ที่มีลักษณะคล้ายกันเข้าด้วยกัน โดยอิงจากจำนวนใบและกลีบดอก

|Leaves _(x1)_|Petals _(x2)_|
|---|---|
|0|5|
|0|6|
|1|3|
|1|3|
|1|6|
|1|8|
|2|3|
|2|7|
|2|8|
## Training a Clustering Model

มีอัลกอริทึมหลายแบบที่สามารถใช้สำหรับ *clustering* ได้  
หนึ่งในอัลกอริทึมที่นิยมที่สุดคือ *K-Means Clustering* ซึ่งทำงานตามขั้นตอนต่อไปนี้:

1. แปลงค่า feature (_x_) ให้อยู่ในรูปเวกเตอร์ เพื่อกำหนดพิกัดในพื้นที่ n มิติ (n = จำนวน feature)  
   ในตัวอย่างดอกไม้ เรามี 2 feature คือจำนวน *ใบ* (x₁) และ *กลีบดอก* (x₂)  
   ดังนั้นแต่ละข้อมูลจะกลายเป็นเวกเตอร์ [x₁, x₂] ซึ่งสามารถวางในกราฟ 2 มิติได้

2. กำหนดจำนวน cluster ที่ต้องการให้โมเดลสร้าง — เรียกจำนวนนี้ว่า *k*  
   เช่น หากต้องการให้จัดกลุ่มเป็น 3 กลุ่ม ให้ตั้งค่า *k = 3* แล้วสุ่มจุดเริ่มต้น 3 จุดในพื้นที่  
   จุดเหล่านี้เรียกว่า *centroids* (จุดศูนย์กลางของแต่ละ cluster)

3. กำหนดให้ข้อมูลแต่ละจุด (เช่น ดอกไม้แต่ละดอก) ไปอยู่ในกลุ่มของ centroid ที่อยู่ใกล้ที่สุด

4. ปรับตำแหน่ง centroid โดยคำนวณจุดศูนย์กลางใหม่จากค่าเฉลี่ยของข้อมูลทั้งหมดใน cluster นั้น

5. หลังจาก centroid เคลื่อนที่แล้ว ข้อมูลแต่ละจุดอาจอยู่ใกล้ centroid อื่นมากกว่าเดิม  
   จึงทำการจัดกลุ่มใหม่อีกครั้งตาม centroid ที่อยู่ใกล้ที่สุด

6. ทำขั้นตอนที่ 4–5 ซ้ำ จนกว่า centroid จะหยุดเคลื่อนที่ (clusters เสถียรแล้ว)  
   หรือถึงจำนวนรอบสูงสุดที่กำหนดไว้ล่วงหน้า

![Diagram of an animation showing the k-means clustering process.](https://learn.microsoft.com/en-us/training/wwl-data-ai/fundamentals-machine-learning/media/clustering.gif)

## Evaluating a Clustering Model

เนื่องจาก *clustering* เป็นการเรียนรู้แบบ *unsupervised*  
จึงไม่มี label ที่รู้ล่วงหน้ามาใช้เปรียบเทียบกับผลลัพธ์การจัดกลุ่ม  
ดังนั้นการประเมินโมเดล clustering จะดูจากว่าแต่ละกลุ่มที่ได้ "แยกออกจากกันได้ดีแค่ไหน"

มีหลายเมตริกที่ใช้ประเมินคุณภาพของการจัดกลุ่ม เช่น:

- **Average distance to cluster center**: ระยะห่างเฉลี่ยของแต่ละจุดในกลุ่มจาก centroid ของกลุ่มนั้น  
  (ยิ่งใกล้ ยิ่งแสดงว่า cluster กระชับ)

- **Average distance to other center**: ระยะห่างเฉลี่ยจากจุดในกลุ่มหนึ่ง ไปยัง centroid ของกลุ่มอื่น ๆ  
  (ยิ่งไกล ยิ่งแสดงว่า cluster แยกตัวดี)

- **Maximum distance to cluster center**: ระยะห่างมากที่สุดจากจุดใน cluster ไปยัง centroid ของกลุ่ม  
  (ช่วยระบุว่ามีจุดใดกระจายออกไปมากเกินไปหรือไม่)

- **Silhouette Score**: ค่าระหว่าง -1 ถึง 1 ที่สรุปความต่างของระยะภายใน cluster กับระยะข้าม cluster  
  (ยิ่งใกล้ 1 ยิ่งแสดงว่า cluster แยกจากกันชัดเจน)