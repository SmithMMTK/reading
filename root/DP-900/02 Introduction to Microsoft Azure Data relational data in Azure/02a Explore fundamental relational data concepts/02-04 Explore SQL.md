_SQL_ ย่อมาจาก _Structured Query Language_ เป็นภาษาที่ใช้ในการสื่อสารกับฐานข้อมูลเชิงสัมพันธ์ (_relational database_) โดยเป็นภาษามาตรฐานสำหรับระบบจัดการฐานข้อมูลแบบเชิงสัมพันธ์ (_relational database management systems_)

คำสั่ง _SQL_ ใช้ในการดำเนินการต่าง ๆ เช่น การอัปเดตข้อมูล (_update data_) หรือดึงข้อมูล (_retrieve data_) จากฐานข้อมูล

ระบบฐานข้อมูลที่นิยมใช้ _SQL_ ได้แก่  
- _Microsoft SQL Server_  
- _MySQL_  
- _PostgreSQL_  
- _MariaDB_  
- _Oracle_

_หมายเหตุ_: _SQL_ ได้รับการกำหนดให้เป็นมาตรฐานครั้งแรกโดย _ANSI (American National Standards Institute)_ ในปี 1986 และโดย _ISO (International Organization for Standardization)_ ในปี 1987 หลังจากนั้น มาตรฐานของ _SQL_ ได้มีการปรับปรุงเพิ่มเติมหลายครั้ง เพื่อรองรับฟีเจอร์ใหม่ ๆ ที่ผู้พัฒนาระบบฐานข้อมูลแต่ละรายได้เพิ่มเข้ามาในระบบของตน นอกจากนี้ ระบบฐานข้อมูลส่วนใหญ่มักจะมีส่วนขยายพิเศษของตนเอง (_proprietary extensions_) ที่ไม่ได้อยู่ในมาตรฐาน ทำให้เกิดความหลากหลายของ _SQL dialects_

เราสามารถใช้คำสั่ง _SQL_ เช่น _SELECT_, _INSERT_, _UPDATE_, _DELETE_, _CREATE_, และ _DROP_ เพื่อทำงานกับฐานข้อมูลแทบทุกอย่างที่ต้องการ

แม้ว่าคำสั่งเหล่านี้จะเป็นส่วนหนึ่งของมาตรฐาน _SQL_ แต่หลายระบบฐานข้อมูลก็มักจะมี _proprietary extensions_ หรือส่วนขยายเฉพาะของตนเอง เพื่อรองรับฟีเจอร์ที่ไม่อยู่ในมาตรฐาน เช่น การจัดการความปลอดภัย (_security management_) และการเขียนโค้ดในฐานข้อมูล (_programmability_)

ตัวอย่างเช่น _Microsoft SQL Server_ และบริการฐานข้อมูลบน _Azure_ ที่ใช้ _SQL Server engine_ จะใช้ _Transact-SQL (T-SQL)_ ซึ่งเป็น _SQL dialect_ ที่เพิ่มความสามารถพิเศษ เช่น  การเขียน _stored procedures_ และ _triggers_ รวมถึงการจัดการบัญชีผู้ใช้ในฐานข้อมูล

ระบบอื่น ๆ ก็มี _SQL dialects_ ของตนเอง เช่น  
- _Transact-SQL (T-SQL)_ ใช้ใน _Microsoft SQL Server_ และ _Azure SQL_  
- _pgSQL_ เป็น dialect ที่ใช้ใน _PostgreSQL_  
- _PL/SQL_ ใช้ใน _Oracle_ (ย่อมาจาก _Procedural Language/SQL_)

ผู้ที่ต้องการทำงานกับระบบฐานข้อมูลใดระบบหนึ่งโดยเฉพาะ ควรศึกษารายละเอียดของ _SQL dialect_ และแพลตฟอร์มนั้นให้เข้าใจลึกซึ้ง

_หมายเหตุ_

ตัวอย่างโค้ด _SQL_ ในโมดูลนี้ใช้รูปแบบของ _Transact-SQL (T-SQL)_ เป็นหลัก เว้นแต่จะมีการระบุไว้เป็นอย่างอื่น ไวยากรณ์ของ _SQL dialect_ อื่น ๆ โดยทั่วไปจะคล้ายกัน แต่บางส่วนอาจมีความแตกต่างในรายละเอียด

## SQL statement types

คำสั่ง _SQL_ สามารถแบ่งออกเป็น 3 กลุ่มหลักตามหน้าที่:

- _Data Definition Language (DDL)_ ใช้สำหรับสร้าง แก้ไข หรือลบโครงสร้างของฐานข้อมูล เช่น _table_, _view_, _stored procedure_
- _Data Control Language (DCL)_ ใช้ควบคุมสิทธิ์การเข้าถึง เช่น การให้สิทธิ์หรือเพิกถอนสิทธิ์ผู้ใช้งาน
- _Data Manipulation Language (DML)_ ใช้จัดการข้อมูลภายใน _table_ เช่น การดึง เพิ่ม แก้ไข หรือลบข้อมูล

### DDL statements

เราจะใช้คำสั่งในกลุ่ม _Data Definition Language (DDL)_ เพื่อสร้าง แก้ไข หรือลบ _table_ และ _object_ อื่น ๆ ภายในฐานข้อมูล เช่น _stored procedures_, _views_ เป็นต้น

คำสั่ง _DDL_ ที่ใช้บ่อย ได้แก่:

- _CREATE_: สร้าง _object_ ใหม่ เช่น _table_ หรือ _view_
- _ALTER_: แก้ไขโครงสร้างของ _object_ เช่น เพิ่ม _column_ ใน _table_
- _DROP_: ลบ _object_ ออกจากฐานข้อมูล
- _RENAME_: เปลี่ยนชื่อ _object_ ที่มีอยู่แล้ว

⚠️ _คำเตือน_ คำสั่ง _DROP_ มีพลังมากและควรใช้อย่างระมัดระวัง เมื่อคุณใช้ _DROP_ ลบ _table_ จะทำให้ _rows_ ทั้งหมดใน _table_ นั้นหายไปทันที หากไม่มีการสำรองข้อมูล (_backup_) ไว้ คุณจะไม่สามารถกู้ข้อมูลกลับมาได้

ตัวอย่างต่อไปนี้เป็นการสร้าง _table_ ใหม่ในฐานข้อมูล โดยในวงเล็บจะระบุรายละเอียดของแต่ละ _column_ เช่น  
ชื่อของ _column_, ประเภทข้อมูล (_data type_), ข้อกำหนดว่าต้องมีค่าหรือไม่ (_NOT NULL_),  
และว่าค่านั้นใช้เพื่อระบุแถว (_row_) อย่างเฉพาะเจาะจงหรือไม่ (_PRIMARY KEY_)

ตามแนวทางที่ดีแล้ว _table_ ทุกตารางควรมี _primary key_ แม้ว่า _SQL_ จะไม่บังคับก็ตาม

_หมายเหตุ_ คอลัมน์ที่ระบุว่า _NOT NULL_ จะเรียกว่า _mandatory columns_ หรือคอลัมน์ที่ต้องมีค่าเสมอ หากไม่ใส่คำสั่ง _NOT NULL_ คุณสามารถสร้างแถว (_row_) ที่ไม่มีค่าบางคอลัมน์ได้ คอลัมน์ที่ไม่มีค่าจะถือว่ามีค่าเป็น _NULL_

```sql
CREATE TABLE Product
(
    ID INT PRIMARY KEY,
    Name VARCHAR(20) NOT NULL,
    Price DECIMAL NULL
);
```

ชนิดข้อมูล (_datatypes_) ที่ใช้ในแต่ละ _column_ ของ _table_ จะแตกต่างกันไปตามแต่ละระบบฐานข้อมูล (_database management system_)

อย่างไรก็ตาม ระบบส่วนใหญ่รองรับชนิดข้อมูลพื้นฐาน เช่น  
- _INT_: ตัวเลขจำนวนเต็ม (_integer_)  
- _DECIMAL_: ตัวเลขทศนิยม  
- _VARCHAR_: ข้อความที่มีความยาวไม่คงที่ (_variable length character data_)

หากต้องการดูรายละเอียดเพิ่มเติม ควรอ้างอิงจากเอกสารของระบบฐานข้อมูลที่คุณใช้งาน

### DCL statements

ผู้ดูแลฐานข้อมูล (_database administrators_) มักใช้คำสั่งในกลุ่ม _Data Control Language (DCL)_ เพื่อจัดการสิทธิ์การเข้าถึง _object_ ต่าง ๆ ในฐานข้อมูล โดยสามารถให้สิทธิ์ (_grant_), ปฏิเสธสิทธิ์ (_deny_) หรือเพิกถอนสิทธิ์ (_revoke_) สำหรับผู้ใช้หรือกลุ่มผู้ใช้เฉพาะได้

คำสั่ง _DCL_ ที่ใช้บ่อยมี 3 คำสั่งหลัก:

| คำสั่ง   | คำอธิบาย                            |
| -------- | ----------------------------------- |
| _GRANT_  | ให้สิทธิ์ในการดำเนินการบางอย่าง     |
| _DENY_   | ปฏิเสธสิทธิ์ในการดำเนินการบางอย่าง  |
| _REVOKE_ | เพิกถอนสิทธิ์ที่เคยให้ไปก่อนหน้านี้ |

ตัวอย่างด้านล่างเป็นคำสั่ง _GRANT_ ที่ให้ผู้ใช้ชื่อ _user1_ สามารถอ่าน (_SELECT_), เพิ่ม (_INSERT_), และแก้ไข (_UPDATE_) ข้อมูลใน _Product table_ ได้:

```sql
GRANT SELECT, INSERT, UPDATE
ON Product
TO user1;
```


### DML statements

คำสั่งในกลุ่ม _Data Manipulation Language (DML)_ ใช้สำหรับจัดการข้อมูลใน _rows_ ของ _tables_

คำสั่งเหล่านี้ช่วยให้สามารถ:
- ดึงข้อมูล (_query_) จาก _table_
- เพิ่ม _row_ ใหม่
- แก้ไข _row_ ที่มีอยู่
- ลบ _row_ ที่ไม่ต้องการใช้งานแล้ว

คำสั่ง _DML_ หลักมีอยู่ 4 คำสั่ง:

| คำสั่ง   | คำอธิบาย                       |
| -------- | ------------------------------ |
| _SELECT_ | อ่านข้อมูลจาก _table_          |
| _INSERT_ | เพิ่ม _rows_ ใหม่ลงใน _table_  |
| _UPDATE_ | แก้ไขข้อมูลใน _rows_ ที่มีอยู่ |
| _DELETE_ | ลบ _rows_ ที่มีอยู่            |

รูปแบบพื้นฐานของคำสั่ง _INSERT_ จะใช้เพิ่มข้อมูลได้ทีละ 1 แถว (_row_) ในแต่ละครั้ง โดยปกติ คำสั่ง _SELECT_, _UPDATE_ และ _DELETE_ จะถูกใช้กับทุกแถวใน _table_ หากไม่ได้ระบุเงื่อนไข ดังนั้นจึงควรใช้ _WHERE clause_ เพื่อระบุเงื่อนไขว่าให้เลือกหรือแก้ไขเฉพาะแถวที่ตรงตามเงื่อนไขเท่านั้น

⚠️ _คำเตือน_  _SQL_ ไม่มีข้อความแจ้งเตือนว่า “แน่ใจหรือไม่” (_are you sure?_)  ดังนั้นควรระวังเป็นพิเศษเมื่อใช้ _DELETE_ หรือ _UPDATE_ โดยไม่มี _WHERE clause_ เพราะอาจทำให้ข้อมูลทั้งหมดถูกลบหรือแก้ไขโดยไม่ตั้งใจ


ตัวอย่างคำสั่ง _SQL_ ด้านล่างนี้จะแสดงทุกคอลัมน์ (_\**_ หมายถึงทุก _column_) จาก _Customer table_ เฉพาะแถวที่มีค่า _City_ เป็น "Seattle":

```sql
SELECT *
FROM Customer
WHERE City = 'Seattle';
```

หากต้องการดึงข้อมูลเฉพาะบาง _columns_ จาก _table_ ให้ระบุชื่อคอลัมน์เหล่านั้นในคำสั่ง _SELECT_ ดังตัวอย่างด้านล่าง:

```sql
SELECT FirstName, LastName, Address, City
FROM Customer
WHERE City = 'Seattle';
```

หากผลลัพธ์จาก _query_ มีหลายแถว (_rows_) ข้อมูลที่แสดงจะไม่เรียงตามลำดับใด ๆ โดยอัตโนมัติ ถ้าต้องการจัดเรียงข้อมูล ให้ใช้ _ORDER BY clause_ โดยระบุชื่อ _column_ ที่ต้องการเรียง

ตัวอย่างด้านล่างนี้จะแสดงข้อมูลจาก _Customer table_ ที่อยู่ในเมือง _Seattle_ และเรียงตาม _LastName_:

```sql
SELECT FirstName, LastName, Address, City
FROM Customer
WHERE City = 'Seattle'
ORDER BY LastName;
```


คุณสามารถใช้คำสั่ง _SELECT_ เพื่อดึงข้อมูลจากหลาย _tables_ พร้อมกันได้โดยใช้คำสั่ง _JOIN_

คำสั่ง _JOIN_ จะกำหนดว่าจะแมป (_match_) แถวจากแต่ละ _table_ อย่างไร  
โดยทั่วไปจะเชื่อมโยง _foreign key_ จาก _table_ หนึ่งกับ _primary key_ ของอีก _table_ หนึ่ง

ตัวอย่างด้านล่างนี้แสดงการเชื่อม _Customer_ และ _Order_ เข้าด้วยกัน  
พร้อมใช้ _alias_ เพื่อย่อชื่อ _table_ ให้อ่านง่ายขึ้นในคำสั่ง _SELECT_ และ _JOIN_:

```sql
SELECT o.OrderNo, o.OrderDate, c.Address, c.City
FROM Order AS o
JOIN Customer AS c
ON o.Customer = c.ID;
```

ตัวอย่างต่อไปนี้แสดงวิธีการแก้ไขข้อมูลในแถว (_row_) ที่มีอยู่แล้วโดยใช้คำสั่ง _SQL_

คำสั่งนี้จะเปลี่ยนค่าของ _Address column_ ใน _Customer table_  
เฉพาะแถวที่มีค่า _ID_ เท่ากับ 1 โดยไม่กระทบแถวอื่น ๆ:

```sql
UPDATE Customer
SET Address = '123 High St.'
WHERE ID = 1;
```

 ⚠️ _คำเตือน_ หากคุณลืมใส่ _WHERE clause_ ในคำสั่ง _UPDATE_ ระบบจะทำการแก้ไข **ทุกแถว** (_every row_) ใน _table_ โดยไม่มีข้อยกเว้น ควรระวังให้มากเมื่อใช้ _UPDATE_ และตรวจสอบให้แน่ใจว่ามี _WHERE_ ระบุเงื่อนไขอย่างชัดเจน
 
ให้ใช้คำสั่ง _DELETE_ เมื่อต้องการลบแถว (_row_) ออกจาก _table_ โดยต้องระบุชื่อ _table_ ที่ต้องการลบข้อมูล และใช้ _WHERE clause_ เพื่อกำหนดว่าแถวไหนควรถูกลบ

```sql
DELETE FROM Product
WHERE ID = 162;
```

⚠️ _คำเตือน_ หากคุณลืมใส่ _WHERE clause_ คำสั่ง _DELETE_ จะลบ **ทุกแถว** (_every row_) ใน _table_ นั้นทันที ควรตรวจสอบให้แน่ใจว่ามีเงื่อนไข _WHERE_ เพื่อป้องกันการสูญหายของข้อมูลโดยไม่ตั้งใจ

คำสั่ง _INSERT_ มีรูปแบบที่แตกต่างจากคำสั่งอื่นเล็กน้อย โดยคุณต้องระบุชื่อ _table_ และ _columns_ ที่ต้องการใส่ข้อมูลในส่วนของ _INTO clause_ จากนั้นตามด้วย _VALUES_ ที่ต้องการใส่ลงไปในคอลัมน์เหล่านั้น มาตรฐาน _SQL_ รองรับการเพิ่มข้อมูลทีละ 1 แถวในแต่ละครั้ง ดังตัวอย่างด้านล่าง:

```sql
INSERT INTO Product(ID, Name, Price)
VALUES (99, 'Drill', 4.99);
```

_หมายเหตุ_ เนื้อหานี้อธิบายคำสั่ง _SQL_ เบื้องต้นและรูปแบบการเขียน เพื่อช่วยให้คุณเข้าใจการใช้งาน _SQL_ กับ _objects_ ภายในฐานข้อมูล หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับการ _query_ ข้อมูลด้วย _SQL_  สามารถศึกษาต่อได้ที่ [Get Started Querying with Transact-SQL](https://learn.microsoft.com/en-us/training/paths/get-started-querying-with-transact-sql) บน Microsoft Learn
