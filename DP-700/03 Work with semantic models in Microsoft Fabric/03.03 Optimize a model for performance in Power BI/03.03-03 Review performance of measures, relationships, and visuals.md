
หาก _semantic model_ ของคุณมีหลาย _tables_ ความสัมพันธ์ที่ซับซ้อน การคำนวณที่ซับซ้อน _visuals_ หลายรายการ หรือข้อมูลที่ซ้ำซ้อน อาจทำให้ประสิทธิภาพของรายงานลดลง ซึ่งส่งผลให้ผู้ใช้งานมีประสบการณ์ที่ไม่ดี

[![Screenshot shows factors that impact on report performance.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-graphic-factors-impacting-performance-c.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-graphic-factors-impacting-performance-c.png#lightbox#lightbox)

เพื่อปรับปรุงประสิทธิภาพ คุณต้องเริ่มจากการระบุแหล่งที่มาของปัญหา กล่าวคือ ค้นหาว่าส่วนใดของ _report_ และ _semantic model_ ที่ทำให้เกิดปัญหาด้านประสิทธิภาพ หลังจากนั้นคุณจึงสามารถดำเนินการแก้ไขเพื่อปรับปรุงประสิทธิภาพได้

## Identify report performance bottlenecks

~~เพื่อให้รายงานของคุณมีประสิทธิภาพสูงสุด คุณต้องสร้าง _semantic model_ ที่มีประสิทธิภาพ ซึ่งรองรับการทำงานของ _queries_ และ _measures_ ได้อย่างรวดเร็ว เมื่อคุณมีพื้นฐานที่ดีแล้ว คุณสามารถปรับปรุงโมเดลเพิ่มเติมได้โดยการวิเคราะห์ _query plans_ และ _dependencies_ แล้วดำเนินการเปลี่ยนแปลงเพื่อเพิ่มประสิทธิภาพให้มากยิ่งขึ้น~~

~~คุณควรตรวจสอบ _measures_ และ _queries_ ภายใน _semantic model_ เพื่อให้แน่ใจว่าคุณใช้วิธีที่มีประสิทธิภาพที่สุดในการดึงผลลัพธ์ตามที่ต้องการ จุดเริ่มต้นควรเป็นการระบุ _bottlenecks_ ที่อยู่ในโค้ด เมื่อคุณระบุ _query_ ที่ช้าที่สุดได้แล้ว คุณสามารถมุ่งเน้นไปที่ _bottleneck_ ที่สำคัญที่สุดก่อน แล้วค่อยจัดลำดับความสำคัญในการแก้ไขปัญหาอื่น ๆ ต่อไป~~

ถ้าคุณอยากให้รายงานทำงานเร็วและลื่นไหล ขั้นแรกคือต้องออกแบบ _semantic model_ ให้ดี เพื่อให้ _query_ และ _measure_ ทำงานได้รวดเร็ว พอมีพื้นฐานที่ดีแล้ว คุณสามารถปรับปรุงต่อได้โดยดูว่าเบื้องหลังแต่ละคำสั่งทำงานยังไง (_query plans_) และข้อมูลไหนต้องพึ่งพาข้อมูลอื่น (_dependencies_) แล้วค่อยแก้จุดที่ทำให้ช้า

ลองเช็กดูว่า _measure_ กับ _query_ ที่คุณใช้ในโมเดลเขียนมาแบบมีประสิทธิภาพหรือยัง เริ่มจากหาว่าโค้ดส่วนไหนช้าที่สุด แล้วค่อยไล่แก้จากจุดนั้นเป็นอันดับแรก จากนั้นค่อยจัดลำดับความสำคัญของปัญหาอื่น ๆ ที่เหลือ

### Analyze performance

คุณสามารถใช้ **Performance Analyzer** ซึ่งเป็นเครื่องมือใน _Power BI Desktop_ เพื่อช่วยตรวจสอบว่าแต่ละองค์ประกอบในรายงานของคุณทำงานอย่างไรเมื่อผู้ใช้มีปฏิสัมพันธ์กับมัน ตัวอย่างเช่น คุณสามารถดูได้ว่า _visual_ ใดใช้เวลานานเท่าใดในการ _refresh_ หลังจากผู้ใช้ทำการโต้ตอบ เครื่องมือนี้จะช่วยให้คุณระบุองค์ประกอบที่อาจก่อให้เกิดปัญหาด้านประสิทธิภาพ ซึ่งเป็นประโยชน์ต่อการ _troubleshooting_

ก่อนที่คุณจะเรียกใช้ **Performance Analyzer** เพื่อให้ผลการวิเคราะห์แม่นยำที่สุด คุณควรเริ่มต้นด้วยการเคลียร์ _visual cache_ และ _data engine cache_

- **Visual cache** – เมื่อคุณโหลด _visual_ แล้ว จะไม่สามารถเคลียร์ _visual cache_ ได้โดยไม่ปิด _Power BI Desktop_ ก่อน ดังนั้นเพื่อหลีกเลี่ยงปัญหาจากการ _cache_ ควรเริ่มการวิเคราะห์โดยไม่มี _visual cache_

  วิธีการคือ ให้เพิ่มหน้าเปล่าหนึ่งหน้าในไฟล์ _Power BI Desktop_ แล้วเลือกหน้านั้นก่อน จากนั้น _save_ แล้ว _close_ ไฟล์ เมื่อคุณเปิดไฟล์ขึ้นมาใหม่ มันจะเริ่มที่หน้าเปล่า

- **Data engine cache** – เมื่อมีการรัน _query_ ระบบจะเก็บผลลัพธ์ไว้ใน _cache_ ซึ่งจะทำให้การวิเคราะห์ของคุณไม่แม่นยำ คุณต้องเคลียร์ _data cache_ ก่อนรัน _visual_ ซ้ำอีกครั้ง

  วิธีการเคลียร์ _data cache_ คือ ปิดและเปิด _Power BI Desktop_ ใหม่ หรือใช้ _DAX Studio_ เชื่อมต่อกับ _semantic model_ แล้วเรียกใช้ฟังก์ชัน **Clear Cache**

เมื่อคุณเคลียร์ทั้งสอง _cache_ และเปิดไฟล์ _Power BI Desktop_ ขึ้นมาในหน้าเปล่าแล้ว ให้ไปที่แถบเมนู **View** แล้วเลือก **Performance Analyzer**

เพื่อเริ่มต้นกระบวนการวิเคราะห์ ให้เลือก **Start recording** จากนั้นเลือกหน้ารายงานที่คุณต้องการวิเคราะห์ แล้วทำการโต้ตอบกับองค์ประกอบของรายงานที่คุณต้องการตรวจสอบ คุณจะเห็นผลลัพธ์ของการโต้ตอบแสดงอยู่ใน _Performance Analyzer pane_ ขณะที่คุณใช้งาน เมื่อเสร็จสิ้น ให้เลือกปุ่ม **Stop**

[![Screenshot shows the Performance Analyzer start button.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-overview-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-overview-ssm.png#lightbox#lightbox)

For more detailed information, see [Use Performance Analyzer to examine report element performance](https://learn.microsoft.com/en-us/power-bi/create-reports/desktop-performance-analyzer/).

### Review results

คุณสามารถตรวจสอบผลลัพธ์ของการทดสอบประสิทธิภาพได้ใน _Performance Analyzer pane_ หากต้องการเรียงลำดับงานตามระยะเวลา ตั้งแต่ยาวที่สุดไปสั้นที่สุด ให้คลิกขวาที่ไอคอน **Sort** ถัดจากหัวคอลัมน์ **Duration (ms)** แล้วเลือก **Total time** แบบ **Descending**

[![Screenshot shows how to sort results in Analyzer.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-sort-results-performance-analyzer-ss.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-sort-results-performance-analyzer-ss.png#lightbox#lightbox)

ข้อมูลบันทึก (_log_) สำหรับแต่ละ _visual_ จะแสดงระยะเวลา (_duration_) ที่ใช้ในการดำเนินการในหมวดงานต่อไปนี้:

- **DAX query** – ระยะเวลาที่ใช้ในการส่ง _query_ จาก _visual_ และระยะเวลาที่ _Power BI_ ใช้ในการส่งผลลัพธ์กลับมา
- **Visual display** – ระยะเวลาที่ใช้ในการแสดงผล _visual_ บนหน้าจอ รวมถึงเวลาที่ใช้ในการโหลดรูปภาพจากเว็บหรือทำ _geocoding_
- **Other** – ระยะเวลาที่ใช้ในการเตรียม _query_ รอให้ _visuals_ อื่นเสร็จ หรือประมวลผลงานเบื้องหลังอื่น ๆ หากหมวดนี้แสดงระยะเวลานาน วิธีที่ดีที่สุดในการลดเวลาในหมวดนี้คือการปรับปรุงประสิทธิภาพของ _DAX queries_ สำหรับ _visuals_ อื่น หรือการลดจำนวน _visuals_ ในรายงาน

[![Screenshot shows categories in performance analyzer results.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-categories-performance-analyze-results-ss.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-categories-performance-analyze-results-ss.png#lightbox#lightbox)

ผลลัพธ์จากการวิเคราะห์จะช่วยให้คุณเข้าใจพฤติกรรมของ _semantic model_ และระบุองค์ประกอบที่ควรปรับปรุงได้ คุณสามารถเปรียบเทียบระยะเวลาของแต่ละองค์ประกอบในรายงาน และระบุองค์ประกอบที่ใช้เวลานาน จากนั้นจึงมุ่งเน้นไปที่องค์ประกอบเหล่านั้นและวิเคราะห์สาเหตุที่ทำให้โหลดช้าในหน้ารายงาน

หากต้องการวิเคราะห์ _queries_ อย่างละเอียดมากขึ้น คุณสามารถใช้ _DAX Studio_ ซึ่งเป็นเครื่องมือแบบ _open-source_ ที่ให้บริการฟรีโดยผู้ให้บริการภายนอก

## Resolve issues and optimize performance

ผลลัพธ์จากการวิเคราะห์จะช่วยให้คุณระบุจุดที่ควรปรับปรุงและโอกาสในการเพิ่มประสิทธิภาพการทำงาน คุณอาจพบว่าจำเป็นต้องปรับปรุง _visuals_, การคำนวณ _DAX_ หรือองค์ประกอบอื่น ๆ ภายใน _semantic model_ ของคุณ ข้อมูลต่อไปนี้จะให้คำแนะนำว่าควรสังเกตสิ่งใดและสามารถเปลี่ยนแปลงอะไรได้บ้าง

### Visuals

หากคุณระบุได้ว่า _visuals_ เป็นคอขวดที่ทำให้ประสิทธิภาพแย่ลง คุณควรหาวิธีปรับปรุงโดยให้กระทบต่อประสบการณ์ผู้ใช้น้อยที่สุด

พิจารณาจำนวน _visuals_ ในแต่ละหน้ารายงาน: ยิ่งมีน้อย ยิ่งทำงานได้เร็วขึ้น ลองถามตัวเองว่า _visual_ นั้นจำเป็นจริงหรือไม่ และเพิ่มคุณค่าให้กับผู้ใช้ปลายทางหรือเปล่า ถ้าคำตอบคือ "ไม่" ก็ควรลบ _visual_ นั้นออก แทนที่จะใช้ _visuals_ หลายชิ้นในหน้าเดียวกัน ลองใช้วิธีอื่นในการแสดงรายละเอียดเพิ่มเติม เช่น _drill-through pages_ หรือ _report page tooltips_

ตรวจสอบจำนวน _fields_ ที่อยู่ในแต่ละ _visual_ ยิ่งคุณมี _visuals_ จำนวนมากในรายงาน ก็ยิ่งมีโอกาสเกิดปัญหาด้านประสิทธิภาพ นอกจากนี้ รายงานที่มี _visuals_ เยอะเกินไปจะดูแออัดและเข้าใจยาก _visual_ หนึ่งตัวไม่ควรมีมากกว่า 100 _fields_ (เช่น _measures_ หรือ _columns_) เพราะจะทำให้โหลดช้า ลองถามตัวเองว่าข้อมูลทั้งหมดที่ใช้ใน _visual_ นั้นจำเป็นจริงหรือไม่ คุณอาจพบว่าสามารถลดจำนวน _fields_ ลงได้

### DAX query

เมื่อคุณตรวจสอบผลลัพธ์ใน _Performance Analyzer pane_ คุณจะเห็นว่า _Power BI Desktop engine_ ใช้เวลาเท่าใดในการประมวลผลแต่ละ _query_ (หน่วยเป็นมิลลิวินาที) จุดเริ่มต้นที่ดีคือการพิจารณา _DAX query_ ใด ๆ ที่ใช้เวลามากกว่า 120 มิลลิวินาที ในตัวอย่างนี้ คุณสามารถระบุได้ว่า _query_ หนึ่งมีระยะเวลาการประมวลผลสูงผิดปกติ

[![Screenshot shows an example of large duration time in Performance Analyzer.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-large-duration-measures-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-large-duration-measures-ssm.png#lightbox#lightbox)

**Performance Analyzer** ช่วยเน้นให้เห็นปัญหาที่อาจเกิดขึ้น แต่ไม่ได้บอกว่าควรปรับปรุงอย่างไร คุณอาจต้องทำการวิเคราะห์เพิ่มเติมว่าเหตุใด _measure_ นี้จึงใช้เวลานานในการประมวลผล โดยสามารถใช้ _DAX Studio_ เพื่อตรวจสอบ _queries_ อย่างละเอียดได้

ตัวอย่างเช่น ให้เลือก **Copy Query** เพื่อคัดลอกสูตรการคำนวณลงในคลิปบอร์ด แล้วนำไปวางใน _DAX Studio_ คุณจะสามารถตรวจสอบขั้นตอนการคำนวณได้อย่างละเอียดมากขึ้น ในตัวอย่างนี้ คุณกำลังพยายามนับจำนวน _products_ ทั้งหมดที่มี _order quantity_ มากกว่าหรือเท่ากับห้า


```excel
Count Customers =
CALCULATE(
    DISTINCTCOUNT(Order[ProductID]),
    FILTER (Order, Order[OrderQty] >= 5)
)
```

หลังจากวิเคราะห์ _query_ แล้ว คุณสามารถใช้ความรู้และประสบการณ์ของตัวเองในการระบุจุดที่เกิดปัญหาด้านประสิทธิภาพ และลองใช้ฟังก์ชัน _DAX_ แบบอื่นเพื่อดูว่าจะช่วยให้ประสิทธิภาพดีขึ้นหรือไม่

ในตัวอย่างต่อไปนี้ ฟังก์ชัน `FILTER` ถูกแทนที่ด้วย `KEEPFILTER` และเมื่อรันทดสอบใหม่ใน **Performance Analyzer** ก็พบว่า _duration_ ลดลง ซึ่งเป็นผลจากการเปลี่ยนฟังก์ชัน

```excel
Count Customers =
CALCULATE(
    DISTINCTCOUNT(Order[ProductID]),
    KEEPFILTERS(Order[OrderQty] >= 5)
)
```

ในกรณีนี้ คุณสามารถแทนที่ฟังก์ชัน `FILTER` ด้วยฟังก์ชัน `KEEPFILTER` เพื่อช่วยลดเวลาในการประมวลผล _query_ ได้อย่างมาก เมื่อคุณทำการเปลี่ยนแปลงแล้ว ให้เคลียร์ _data cache_ ก่อน จากนั้นทำกระบวนการ **Performance Analyzer** ซ้ำอีกครั้งเพื่อเช็กว่า _duration time_ ดีขึ้นหรือไม่

[![Screenshot shows an example of small duration time in Performance Analyzer.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-small-duration-measures-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-performance-analyzer-small-duration-measures-ssm.png#lightbox#lightbox)

### Semantic model

หาก _measures_ และการแสดงผลของ _visuals_ มีค่า _duration_ ต่ำ (คือใช้เวลาน้อย) แสดงว่าไม่ได้เป็นสาเหตุของปัญหาด้านประสิทธิภาพ แต่ถ้า _DAX query_ มีค่า _duration_ สูง แสดงว่าอาจเกิดจากการเขียน _measure_ ที่ไม่มีประสิทธิภาพ หรือมีปัญหาใน _semantic model_ เช่น ความสัมพันธ์ระหว่างตาราง, คอลัมน์ที่ไม่จำเป็น, หรือ _metadata_ ที่ไม่เหมาะสม อีกสาเหตุหนึ่งอาจมาจากการเปิดใช้งาน **Auto date/time** ซึ่งจะกล่าวถึงในหัวข้อถัดไป

### Relationships

คุณควรตรวจสอบความสัมพันธ์ใน _model_ ระหว่างตารางให้แน่ใจว่าได้กำหนดความสัมพันธ์ไว้อย่างถูกต้อง ตรวจสอบให้แน่ใจว่าคุณตั้งค่า _cardinality_ ถูกต้อง เช่น คอลัมน์ฝั่งหนึ่งที่ควรมีค่าไม่ซ้ำ (_unique_) อาจถูกตั้งเป็นฝั่งหลาย (_many-side_) โดยไม่ตั้งใจ ซึ่งอาจทำให้ประสิทธิภาพแย่ลง คุณจะได้เรียนรู้เพิ่มเติมเกี่ยวกับผลของ _cardinality_ ต่อประสิทธิภาพในภายหลัง

### Columns

แนวปฏิบัติที่ดีคือไม่ควรนำเข้าคอลัมน์ที่คุณไม่จำเป็นต้องใช้ หากเป็นไปได้ ควรจัดการตั้งแต่ต้นทางก่อนนำเข้าข้อมูลเข้าสู่ Power BI Desktop แทนที่จะลบใน Power Query แต่หากคุณไม่สามารถลบคอลัมน์จากต้นทางได้ หรือข้อมูลถูกนำเข้าแบบ _raw_ แล้ว คุณสามารถใช้ Power Query เพื่อตรวจสอบแต่ละคอลัมน์ ถามตัวเองว่าแต่ละคอลัมน์จำเป็นหรือไม่ และมีประโยชน์อะไรกับ _semantic model_ หากไม่มีประโยชน์ ควรลบทิ้ง

ตัวอย่างเช่น หากคุณมีคอลัมน์ ID ที่มีแถวไม่ซ้ำกันหลายพันแถว และคุณรู้ว่าจะไม่ใช้คอลัมน์นี้ในการเชื่อมตารางหรือรายงานใด ๆ คุณควรลบคอลัมน์นี้ออก เพราะมันเปลืองพื้นที่โดยไม่จำเป็น

การลบคอลัมน์ที่ไม่จำเป็นจะช่วยลดขนาดของ _semantic model_ ซึ่งจะทำให้ขนาดไฟล์เล็กลงและเวลา _refresh_ เร็วขึ้น และเนื่องจากโมเดลมีเฉพาะข้อมูลที่เกี่ยวข้อง ประสิทธิภาพโดยรวมของรายงานจะดีขึ้น

ดูข้อมูลเพิ่มเติมได้ที่ [Data reduction techniques for Import modeling](https://learn.microsoft.com/en-us/power-bi/guidance/import-modeling-data-reduction/)

### Metadata

_Metadata_ คือข้อมูลเกี่ยวกับข้อมูลอื่น ๆ _Metadata_ ใน Power BI จะเก็บข้อมูลเกี่ยวกับ _semantic model_ เช่น ชื่อ, ชนิดข้อมูล, รูปแบบของแต่ละคอลัมน์, โครงสร้างฐานข้อมูล, การออกแบบรายงาน, เวลาที่แก้ไขล่าสุด, ความถี่ในการ _refresh_ และอื่น ๆ

เมื่อคุณโหลดข้อมูลเข้าสู่ Power BI Desktop ควรวิเคราะห์ _metadata_ ที่เกี่ยวข้องเพื่อระบุความไม่สอดคล้องใน _semantic model_ และทำการปรับให้เหมาะสมก่อนเริ่มสร้างรายงาน การวิเคราะห์ _metadata_ สามารถช่วยปรับปรุงประสิทธิภาพของ _semantic model_ ได้ เพราะคุณอาจพบคอลัมน์ที่ไม่จำเป็น, ข้อผิดพลาดในข้อมูล, ชนิดข้อมูลที่ไม่ถูกต้อง, หรือปริมาณข้อมูลที่มากเกินไป (เช่น โมเดลที่โหลดข้อมูลธุรกรรมหรือข้อมูลย้อนหลังจำนวนมาก จะโหลดช้า)

คุณสามารถใช้ Power Query ใน Power BI Desktop เพื่อตรวจสอบคอลัมน์, แถว และค่าต่าง ๆ ของข้อมูลต้นทาง จากนั้นใช้เครื่องมือที่มีอยู่เพื่อดำเนินการเปลี่ยนแปลงตามต้องการ

[![Screenshot shows the Power Query Editor window Home ribbon tab options, which are described in the following paragraph.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-query-editor-home-tab-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-query-editor-home-tab-ssm.png#lightbox#lightbox)

ตัวเลือกใน Power Query มีดังนี้:

- **Unnecessary columns** – ประเมินความจำเป็นของแต่ละคอลัมน์ หากมีคอลัมน์ที่ไม่ได้ใช้งานในรายงานและไม่จำเป็น ควรลบทิ้งโดยใช้ตัวเลือก **Remove Columns**

- **Unnecessary rows** – ตรวจสอบแถวแรก ๆ ใน _semantic model_ ว่ามีข้อมูลว่างหรือข้อมูลที่ไม่จำเป็นต่อรายงานหรือไม่ หากมีให้ลบทิ้งโดยใช้ตัวเลือก **Remove Rows**

- **Data type** – ตรวจสอบชนิดข้อมูลของแต่ละคอลัมน์ให้แน่ใจว่าถูกต้อง หากพบว่าชนิดข้อมูลผิด ให้เลือกคอลัมน์นั้น จากนั้นไปที่แถบ **Transform** แล้วเลือก **Data Type** และเปลี่ยนเป็นชนิดข้อมูลที่ถูกต้อง

- **Query names** – ตรวจสอบชื่อของ _query_ (ตาราง) ใน _Queries pane_ เช่นเดียวกับการตั้งชื่อหัวคอลัมน์ ควรเปลี่ยนชื่อ _query_ ที่ไม่สื่อความหมายหรือเข้าใจยาก ให้เป็นชื่อที่ชัดเจนหรือผู้ใช้คุ้นเคย โดยคลิกขวาที่ _query_ แล้วเลือก **Rename** แก้ไขชื่อ แล้วกด **Enter**

- **Column details** – Power Query มีตัวเลือกสำหรับดูตัวอย่างข้อมูล (_data preview_) ของแต่ละคอลัมน์เพื่อช่วยวิเคราะห์ _metadata_ ที่เกี่ยวข้อง ซึ่งอยู่ในแถบ **View** ประกอบด้วย:
    - **Column quality** – แสดงเปอร์เซ็นต์ของข้อมูลในคอลัมน์ที่ถูกต้อง, มีข้อผิดพลาด หรือว่าง หากเปอร์เซ็นต์ข้อมูลถูกต้องไม่ถึง 100% ควรตรวจสอบสาเหตุ แก้ไขข้อผิดพลาด และเติมค่าที่ว่าง
    - **Column distribution** – แสดงความถี่และการกระจายของค่าต่าง ๆ ในแต่ละคอลัมน์ คุณจะได้ศึกษาเพิ่มเติมในหัวข้อต่อไปของโมดูลนี้
    - **Column profile** – แสดงแผนภูมิ _column statistics_ และแผนภูมิ _column distribution_

[![Screenshot shows the Power Query Editor window column profile options.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-data-preview-column-profile-options-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-data-preview-column-profile-options-ssm.png#lightbox#lightbox)

 Note

หากคุณกำลังตรวจสอบ _query_ ที่มีมากกว่า 1,000 แถว และต้องการวิเคราะห์ทั้ง _semantic model_ ให้เปลี่ยนค่าตั้งต้นที่อยู่ด้านล่างของหน้าต่าง โดยเลือก **Column profiling based on top 1000 rows** > **Column profiling based on entire data set**

[![Screenshot shows the Power Query Editor window column profile rows.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-column-profile-rows-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-column-profile-rows-ssm.png#lightbox#lightbox)

_Metadata_ อื่นที่คุณควรพิจารณาคือข้อมูลเกี่ยวกับ _semantic model_ โดยรวม เช่น ขนาดไฟล์ และความถี่ในการ _refresh_ ข้อมูล ซึ่งสามารถดูได้จากไฟล์ Power BI Desktop (.pbix)

ข้อมูลที่โหลดเข้าสู่ Power BI Desktop จะถูกบีบอัดและจัดเก็บลงดิสก์โดย _VertiPaq storage engine_ ขนาดของ _semantic model_ ส่งผลโดยตรงต่อประสิทธิภาพ: โมเดลที่มีขนาดเล็กกว่าจะใช้ทรัพยากร (_memory_) น้อยกว่า และสามารถ _refresh_ ข้อมูล, คำนวณ, และแสดงผล _visuals_ ได้เร็วขึ้น

### Auto date/time feature

อีกหนึ่งสิ่งที่ควรพิจารณาในการเพิ่มประสิทธิภาพคือการตั้งค่า **Auto date/time** ใน Power BI Desktop โดยค่าดีฟอลต์ของฟีเจอร์นี้คือเปิดใช้งานในระดับ _global_ ซึ่งหมายความว่า Power BI Desktop จะสร้าง _calculated table_ ที่ซ่อนอยู่สำหรับแต่ละคอลัมน์วันที่โดยอัตโนมัติ หากตรงตามเงื่อนไขที่กำหนด ตารางที่ซ่อนนี้จะเป็นตารางเพิ่มเติมจากตารางที่คุณมีอยู่แล้วใน _semantic model_

ตัวเลือก **Auto date/time** ช่วยให้คุณสามารถใช้ _time intelligence_ ได้สะดวก เช่น การกรอง การจัดกลุ่ม หรือการ _drill down_ ตามช่วงเวลาในปฏิทิน เราแนะนำให้เปิดใช้งานฟีเจอร์นี้เฉพาะในกรณีที่คุณทำงานกับช่วงเวลาปฏิทินและโมเดลมีความต้องการเกี่ยวกับเวลาในระดับง่าย

หากแหล่งข้อมูลของคุณมี _date dimension table_ อยู่แล้ว ซึ่งเป็นตารางที่กำหนดเวลาอย่างสม่ำเสมอในองค์กร ควรใช้ตารางนั้นเป็นหลัก และปิดการใช้งาน **Auto date/time** เพื่อช่วยลดขนาดของ _semantic model_ และลดเวลาในการ _refresh_

คุณสามารถเปิด/ปิดฟีเจอร์ **Auto date/time** ได้ทั้งในระดับ _global_ (มีผลกับทุกไฟล์ Power BI Desktop) หรือระดับ _current file_ (มีผลเฉพาะไฟล์เดียว)

วิธีเปิด/ปิด **Auto date/time**:
ไปที่ **File** > **Options and settings** > **Options** จากนั้นเลือกหน้า **Global** หรือ **Current File** แล้วไปที่หัวข้อ **Data Load** ภายใต้ส่วน **Time Intelligence** ให้เลือกหรือยกเลิกเครื่องหมายในช่องตามต้องการ

[![Screenshot shows how to configure auto date time.](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-auto-date-time-configure-global-options-ssm.png)](https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/media/2-auto-date-time-configure-global-options-ssm.png#lightbox#lightbox)

For an overview and general introduction to the **Auto date/time** feature, see [Apply auto date/time in Power BI Desktop](https://learn.microsoft.com/en-us/power-bi/transform-model/desktop-auto-date-time/).

---

## Next unit: Use variables to improve performance and troubleshooting