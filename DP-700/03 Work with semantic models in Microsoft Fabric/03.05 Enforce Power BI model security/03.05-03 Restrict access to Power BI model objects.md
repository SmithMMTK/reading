
ในฐานะ _data modeler_ คุณสามารถพิจารณาจำกัดการเข้าถึงวัตถุใน _Power BI model_ ได้ โดยใช้ **Object-level security (OLS)** เพื่อจำกัดการเข้าถึง _tables_ และ _columns_ รวมถึงข้อมูลเมตา (_metadata_) ของวัตถุเหล่านั้น โดยทั่วไปจะใช้ OLS กับวัตถุที่เก็บข้อมูลอ่อนไหว เช่น ข้อมูลส่วนบุคคลของพนักงาน

เมื่อ _Power BI_ บังคับใช้ _OLS_ ระบบจะไม่เพียงจำกัดการเข้าถึงข้อมูล แต่ยังป้องกันไม่ให้เข้าถึงข้อมูลเมตาด้วย เช่น การเรียกดูผ่าน [Dynamic Management Views (DMVs)](https://learn.microsoft.com/en-us/analysis-services/instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services)

> **Important**  
> _Tabular models_ สามารถซ่อนตารางหรือคอลัมน์ได้ผ่าน [perspective](https://learn.microsoft.com/en-us/analysis-services/tabular-models/perspectives-ssas-tabular) ซึ่งช่วยให้ผู้เขียนรายงานมองเห็นเฉพาะส่วนที่เกี่ยวข้อง แต่ _perspective_ ไม่ใช่กลไกด้านความปลอดภัย ผู้ใช้ยังสามารถดึงข้อมูลจากตารางหรือคอลัมน์ที่ถูกซ่อนได้หากทราบชื่อ

ตัวอย่างจาก Adventure Works: องค์กรมีตารางมิติชื่อ **DimEmployee** ซึ่งมีคอลัมน์ชื่อพนักงาน เบอร์โทร อีเมล และเงินเดือน โดยผู้ใช้ทั่วไปสามารถดูชื่อและข้อมูลติดต่อได้ แต่ดูข้อมูลเงินเดือนไม่ได้ เฉพาะฝ่ายบุคคลระดับสูงเท่านั้นที่เข้าถึงได้ _data modeler_ จึงใช้ **OLS** เพื่อจำกัดสิทธิ์เฉพาะคอลัมน์เงินเดือนให้แก่เฉพาะกลุ่มบุคลากรฝ่ายบุคคล

![Screenshot shows a model diagram view of the Employee table, which includes the restricted Salary column.](https://learn.microsoft.com/en-us/training/wwl-data-ai/enforce-power-bi-model-security/media/employee-table-restrict-salary-column-object-level-security.png)

_OLS_ เป็นฟีเจอร์ที่สืบทอดมาจาก _Azure Analysis Services (AAS)_ และ _SQL Server Analysis Services (SSAS)_ โดยสามารถใช้งานใน _Power BI Premium_ เพื่อรองรับการย้ายโมเดลเก่าเข้ามาใน _Power BI_ ดังนั้นจึงไม่สามารถตั้งค่า OLS ได้โดยตรงใน _Power BI Desktop_

## Set up OLS

การตั้งค่า _OLS_ เริ่มจากการสร้าง _roles_ โดยสามารถทำได้ใน _Power BI Desktop_ เช่นเดียวกับการตั้งค่า _RLS_ แต่ขั้นตอนการเพิ่มกฎ OLS ต้องทำผ่านช่องทางอื่น เนื่องจาก _Power BI Desktop_ ไม่รองรับ

คุณสามารถเพิ่มกฎ OLS ให้กับโมเดลใน _Power BI Desktop_ โดยใช้ [XML for Analysis (XMLA) endpoint](https://learn.microsoft.com/en-us/power-bi/enterprise/service-premium-connect-tools) ซึ่งเปิดใช้งานใน _Power BI Premium_ และให้การเข้าถึง _Analysis Services engine_ ใน _Power BI service_

เครื่องมือที่ใช้ตั้งค่าได้ ได้แก่:

- API ที่รองรับ XMLA เช่น [Tabular Model Scripting Language (TMSL)](https://learn.microsoft.com/en-us/analysis-services/tmsl/tabular-model-scripting-language-tmsl-reference)
- [PowerShell SqlServer module](https://www.powershellgallery.com/packages/SqlServer/)
- เครื่องมือฝั่งลูกข่าย เช่น _SSMS_
- เครื่องมือของบุคคลที่สาม เช่น [Tabular Editor](https://tabulareditor.github.io/TabularEditor/)

โดยค่าเริ่มต้น ทุกตารางและคอลัมน์ในโมเดลจะไม่ถูกจำกัด (ไม่มี OLS) คุณสามารถตั้งค่าได้เป็น **None** หรือ **Read**

- ถ้าตั้งเป็น **None** ผู้ใช้ใน _role_ นั้นจะไม่สามารถเข้าถึงวัตถุนั้นได้เลย
- ถ้าตั้งเป็น **Read** ผู้ใช้จะสามารถเข้าถึงวัตถุได้ตามปกติ

หากต้องการจำกัดคอลัมน์เฉพาะ อย่าลืมตรวจสอบให้แน่ใจว่าตารางแม่ไม่ได้ถูกตั้งเป็น **None**

เมื่อเพิ่มกฎ OLS เสร็จแล้ว คุณสามารถเผยแพร่โมเดลไปยัง _Power BI service_ และใช้กระบวนการเดียวกับ RLS ในการแมปบัญชีผู้ใช้หรือกลุ่มความปลอดภัยกับ _roles_

## Considerations

ในรายงาน Power BI หากผู้ใช้ไม่มีสิทธิ์เข้าถึงตารางหรือคอลัมน์ ระบบจะแสดงข้อความแจ้งข้อผิดพลาด โดยแจ้งว่าวัตถุไม่สามารถเข้าถึงได้

![Screenshot shows a Power B I Desktop error message when a report visual attempts to query a restricted column.](https://learn.microsoft.com/en-us/training/wwl-data-ai/enforce-power-bi-model-security/media/fields-need-to-fixed-object-level-security.png)

ควรพิจารณาอย่างรอบคอบว่า OLS เหมาะกับโปรเจกต์หรือไม่ เพราะหากผู้ใช้เปิดรายงานแล้วพบข้อความผิดพลาด อาจรู้สึกว่าส่วนหนึ่งของรายงานเสียหาย วิธีที่ดีกว่าอาจเป็นการแยกชุดรายงานหรือโมเดลต่างหากให้เหมาะสมกับกลุ่มผู้ใช้งานแต่ละกลุ่ม

## Restrictions

ข้อจำกัดที่ควรทราบในการใช้งาน _OLS_ มีดังนี้:

- ไม่สามารถใช้ _RLS_ และ _OLS_ ร่วมกันใน _role_ เดียวได้ หากต้องใช้ทั้งสอง ต้องแยก _roles_ สำหรับแต่ละประเภท
- ไม่สามารถกำหนดสิทธิ์ในระดับตาราง (_table-level security_) ได้หากจะทำให้ความสัมพันธ์ในโมเดลขาดช่วง เช่น หากมีความสัมพันธ์ A → B และ B → C จะไม่สามารถกำหนด OLS กับ B ได้ เพราะจะทำให้ A ไม่สามารถเข้าถึง C ผ่าน B ได้

![Diagram shows the relationship example described in the previous paragraph.](https://learn.microsoft.com/en-us/training/wwl-data-ai/enforce-power-bi-model-security/media/model-relationships-object-level-security.png)

แต่ถ้าเป็น _relationship_ ที่อ้างอิงเฉพาะคอลัมน์ที่ถูกจำกัด ก็ยังสามารถใช้งานได้ตราบใดที่ตารางนั้นไม่ถูกจำกัดทั้งหมด

สุดท้าย ถึงแม้ไม่สามารถจำกัดการเข้าถึง _measures_ ได้โดยตรง แต่หาก _measure_ ใดอ้างอิงคอลัมน์หรือวัตถุที่ถูกจำกัด สิทธิ์ของ _measure_ นั้นก็จะถูกจำกัดตามไปด้วย

ดูข้อมูลเพิ่มเติมได้ที่ [Object-level security](https://learn.microsoft.com/en-us/analysis-services/tabular-models/object-level-security)

---

## Next unit: Apply good modeling practices